<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tabulator Â§öÈ†ÅÁ±§ Excel ÂåØÂá∫</title>
    
    <!-- Tabulator CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/tabulator/5.5.0/css/tabulator.min.css" rel="stylesheet">
    
    <!-- ExcelJS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/exceljs/4.3.0/exceljs.min.js"></script>
    
    <!-- Tabulator JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tabulator/5.5.0/js/tabulator.min.js"></script>
    
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            text-align: center;
        }
        
        .tabs-container {
            position: relative;
            background-color: #f8f9fa;
            border-bottom: 1px solid #dee2e6;
            overflow: hidden;
        }
        
        .tabs-wrapper {
            display: flex;
            align-items: center;
        }
        
        .tabs-nav-btn {
            background: linear-gradient(135deg, #6c757d 0%, #495057 100%);
            color: white;
            border: none;
            padding: 12px 15px;
            cursor: pointer;
            font-size: 16px;
            min-width: 50px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            border-right: 1px solid #dee2e6;
        }
        
        .tabs-nav-btn:hover:not(:disabled) {
            background: linear-gradient(135deg, #495057 0%, #343a40 100%);
            transform: translateY(-1px);
        }
        
        .tabs-nav-btn:disabled {
            background: #e9ecef;
            color: #adb5bd;
            cursor: not-allowed;
            transform: none;
        }
        
        .tabs-nav-btn.right {
            border-right: none;
            border-left: 1px solid #dee2e6;
        }
        
        .tabs-viewport {
            flex: 1;
            overflow: hidden;
            position: relative;
        }
        
        .tabs {
            display: flex;
            transition: transform 0.3s ease;
            width: max-content;
        }
        
        .tab {
            padding: 12px 24px;
            cursor: pointer;
            background-color: #e9ecef;
            border: none;
            border-right: 1px solid #dee2e6;
            transition: all 0.3s ease;
            white-space: nowrap;
            min-width: 120px;
            flex-shrink: 0;
        }
        
        .tab:hover {
            background-color: #d1ecf1;
        }
        
        .tab.active {
            background-color: white;
            border-bottom: 2px solid #007bff;
            color: #007bff;
            font-weight: bold;
        }
        
        .tabs-indicator {
            position: absolute;
            bottom: 0;
            right: 10px;
            background: rgba(0,123,255,0.1);
            color: #007bff;
            padding: 5px 10px;
            border-radius: 10px 10px 0 0;
            font-size: 12px;
            z-index: 10;
        }
        
        .tab-content {
            display: none;
            padding: 20px;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .search-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .search-input {
            padding: 8px 12px;
            border: 2px solid #e9ecef;
            border-radius: 5px;
            font-size: 14px;
            min-width: 250px;
            transition: border-color 0.3s ease;
        }
        
        .search-input:focus {
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 3px rgba(0,123,255,0.1);
        }
        
        .clear-btn {
            background: #6c757d;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s ease;
        }
        
        .clear-btn:hover {
            background: #545b62;
        }
        
        .export-btn {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 20px;
            transition: transform 0.2s ease;
        }
        
        .export-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(40, 167, 69, 0.3);
        }
        
        .tabulator {
            margin-top: 10px;
            border: 1px solid #dee2e6;
            border-radius: 5px;
        }
        
        /* Ëá™ÂÆöÁæ© Tabulator Ê®£Âºè */
        .tabulator .tabulator-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .tabulator .tabulator-header .tabulator-col {
            border-right: 1px solid rgba(255,255,255,0.2);
        }
        
        .tabulator .tabulator-header .tabulator-col-title {
            color: white;
            font-weight: bold;
        }
        
        .tabulator .tabulator-header .tabulator-col .tabulator-col-sorter {
            color: white;
        }
        
        .tabulator .tabulator-row:nth-child(even) {
            background-color: #f8f9fa;
        }
        
        .tabulator .tabulator-row:hover {
            background-color: #e3f2fd !important;
        }
        
        .high-value {
            background-color: #d4edda !important;
            color: #155724 !important;
            font-weight: bold;
            padding: 4px 8px;
            border-radius: 3px;
        }
        
        .medium-value {
            background-color: #fff3cd !important;
            color: #856404 !important;
            font-weight: bold;
            padding: 4px 8px;
            border-radius: 3px;
        }
        
        .low-value {
            background-color: #f8d7da !important;
            color: #721c24 !important;
            font-weight: bold;
            padding: 4px 8px;
            border-radius: 3px;
        }
        
        /* ÂäüËÉΩÊåâÈàïÊ®£Âºè */
        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 8px;
            align-items: center;
        }
        
        .action-icon {
            font-size: 16px;
            cursor: pointer;
            padding: 4px;
            border-radius: 3px;
            transition: all 0.2s ease;
            user-select: none;
        }
        
        .action-icon.enabled:hover {
            background-color: rgba(0,0,0,0.1);
            transform: scale(1.1);
        }
        
        .action-icon.disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }
        
        .permission-icon.unlocked {
            color: #28a745;
        }
        
        .permission-icon.locked {
            color: #dc3545;
        }
        
        .edit-icon.enabled {
            color: #007bff;
        }
        
        .delete-icon.enabled {
            color: #dc3545;
        }
        
        .copy-icon.enabled {
            color: #28a745;
        }
        
        .add-btn {
            background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
            color: white;
            padding: 8px 16px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: transform 0.2s ease;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .add-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0, 123, 255, 0.3);
        }
        
        /* Â§öË°åÊñáÂ≠óÊ®£Âºè */
        .multiline-cell {
            white-space: pre-wrap;
            word-wrap: break-word;
            max-width: 200px;
            line-height: 1.4;
            min-height: 20px;
        }
        
        /* ÈéñÂÆöÊ¨Ñ‰ΩçÊ®£Âºè */
        .locked-cell {
            background-color: #f8f9fa !important;
            color: #6c757d !important;
            cursor: not-allowed !important;
            position: relative;
        }
        
        .locked-cell::before {
            content: "üîí";
            position: absolute;
            top: 2px;
            right: 2px;
            font-size: 10px;
            opacity: 0.6;
        }
        
        /* Ëá™ÂãïË™øÊï¥È´òÂ∫¶ÁöÑË°®Ê†ºË°å */
        .tabulator .tabulator-row {
            min-height: 40px !important;
        }

        .tabulator .tabulator-cell {
            white-space: pre-wrap !important;
            word-break: break-word !important;
            vertical-align: top !important;
            padding: 8px !important;
        }
        
        /* ÈüøÊáâÂºèË®≠Ë®à */
        @media (max-width: 768px) {
            .controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .search-input {
                min-width: 100%;
            }
            
            .tabs {
                flex-wrap: wrap;
            }
            
            .tab {
                flex: 1;
                min-width: 120px;
            }
            
            .action-buttons {
                gap: 4px;
            }
            
            .action-icon {
                font-size: 14px;
                padding: 2px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìä Tabulator Â§öÈ†ÅÁ±§Ë≥áÊñôÁÆ°ÁêÜÁ≥ªÁµ±</h1>
            <p>ÊîØÊè¥Â§öÂ∑•‰ΩúË°® Excel ÂåØÂá∫„ÄÅÊêúÂ∞ãÊéíÂ∫èËàáÂÑ≤Â≠òÊ†ºÊ®£ÂºèË®≠ÂÆö</p>
        </div>
        
        <div class="tabs-container">
            <div class="tabs-wrapper">
                <button class="tabs-nav-btn left" id="tabs-left-btn" onclick="scrollTabs('left')" disabled>
                    ‚óÄ
                </button>
                <div class="tabs-viewport" id="tabs-viewport">
                    <div class="tabs" id="tabs-container">
                        <button class="tab active" data-tab="sales" onclick="showTab('sales', this)">Èä∑ÂîÆË≥áÊñô</button>
                        <button class="tab" data-tab="inventory" onclick="showTab('inventory', this)">Â∫´Â≠òË≥áÊñô</button>
                        <button class="tab" data-tab="employees" onclick="showTab('employees', this)">Âì°Â∑•Ë≥áÊñô</button>
                        <button class="tab" data-tab="products" onclick="showTab('products', this)">Áî¢ÂìÅË≥áÊñô</button>
                        <button class="tab" data-tab="customers" onclick="showTab('customers', this)">ÂÆ¢Êà∂Ë≥áÊñô</button>
                        <button class="tab" data-tab="orders" onclick="showTab('orders', this)">Ë®ÇÂñÆË≥áÊñô</button>
                        <button class="tab" data-tab="suppliers" onclick="showTab('suppliers', this)">‰æõÊáâÂïÜË≥áÊñô</button>
                        <button class="tab" data-tab="reports" onclick="showTab('reports', this)">Â†±Ë°®ÂàÜÊûê</button>
                        <button class="tab" data-tab="settings" onclick="showTab('settings', this)">Á≥ªÁµ±Ë®≠ÂÆö</button>
                    </div>
                </div>
                <button class="tabs-nav-btn right" id="tabs-right-btn" onclick="scrollTabs('right')">
                    ‚ñ∂
                </button>
            </div>
            <div class="tabs-indicator" id="tabs-indicator">
                1 / 9
            </div>
        </div>
        
        <div id="sales" class="tab-content active">
            <div class="controls">
                <h3>üõí Èä∑ÂîÆË≥áÊñô</h3>
                <div class="search-container">
                    <button class="add-btn" onclick="addNewRow('sales')">
                        ‚ûï Êñ∞Â¢ûË≥áÊñô
                    </button>
                    <input type="text" id="sales-search" class="search-input" placeholder="üîç ÊêúÂ∞ãÈä∑ÂîÆË≥áÊñô..." onkeyup="searchTable('sales', this.value)">
                    <button class="clear-btn" onclick="clearSearch('sales')">Ê∏ÖÈô§</button>
                </div>
            </div>
            <div id="sales-table"></div>
        </div>
        
        <div id="inventory" class="tab-content">
            <div class="controls">
                <h3>üì¶ Â∫´Â≠òË≥áÊñô</h3>
                <div class="search-container">
                    <button class="add-btn" onclick="addNewRow('inventory')">
                        ‚ûï Êñ∞Â¢ûË≥áÊñô
                    </button>
                    <input type="text" id="inventory-search" class="search-input" placeholder="üîç ÊêúÂ∞ãÂ∫´Â≠òË≥áÊñô..." onkeyup="searchTable('inventory', this.value)">
                    <button class="clear-btn" onclick="clearSearch('inventory')">Ê∏ÖÈô§</button>
                </div>
            </div>
            <div id="inventory-table"></div>
        </div>
        
        <div id="employees" class="tab-content">
            <div class="controls">
                <h3>üë• Âì°Â∑•Ë≥áÊñô</h3>
                <div class="search-container">
                    <button class="add-btn" onclick="addNewRow('employees')">
                        ‚ûï Êñ∞Â¢ûË≥áÊñô
                    </button>
                    <input type="text" id="employees-search" class="search-input" placeholder="üîç ÊêúÂ∞ãÂì°Â∑•Ë≥áÊñô..." onkeyup="searchTable('employees', this.value)">
                    <button class="clear-btn" onclick="clearSearch('employees')">Ê∏ÖÈô§</button>
                </div>
            </div>
            <div id="employees-table"></div>
        </div>
        
        <div id="products" class="tab-content">
            <div class="controls">
                <h3>üì± Áî¢ÂìÅË≥áÊñô</h3>
                <div class="search-container">
                    <button class="add-btn" onclick="addNewRow('products')">
                        ‚ûï Êñ∞Â¢ûË≥áÊñô
                    </button>
                    <input type="text" id="products-search" class="search-input" placeholder="üîç ÊêúÂ∞ãÁî¢ÂìÅË≥áÊñô..." onkeyup="searchTable('products', this.value)">
                    <button class="clear-btn" onclick="clearSearch('products')">Ê∏ÖÈô§</button>
                </div>
            </div>
            <div id="products-table"></div>
        </div>
        
        <div id="customers" class="tab-content">
            <div class="controls">
                <h3>üë§ ÂÆ¢Êà∂Ë≥áÊñô</h3>
                <div class="search-container">
                    <button class="add-btn" onclick="addNewRow('customers')">
                        ‚ûï Êñ∞Â¢ûË≥áÊñô
                    </button>
                    <input type="text" id="customers-search" class="search-input" placeholder="üîç ÊêúÂ∞ãÂÆ¢Êà∂Ë≥áÊñô..." onkeyup="searchTable('customers', this.value)">
                    <button class="clear-btn" onclick="clearSearch('customers')">Ê∏ÖÈô§</button>
                </div>
            </div>
            <div id="customers-table"></div>
        </div>
        
        <div id="orders" class="tab-content">
            <div class="controls">
                <h3>üìã Ë®ÇÂñÆË≥áÊñô</h3>
                <div class="search-container">
                    <button class="add-btn" onclick="addNewRow('orders')">
                        ‚ûï Êñ∞Â¢ûË≥áÊñô
                    </button>
                    <input type="text" id="orders-search" class="search-input" placeholder="üîç ÊêúÂ∞ãË®ÇÂñÆË≥áÊñô..." onkeyup="searchTable('orders', this.value)">
                    <button class="clear-btn" onclick="clearSearch('orders')">Ê∏ÖÈô§</button>
                </div>
            </div>
            <div id="orders-table"></div>
        </div>
        
        <div id="suppliers" class="tab-content">
            <div class="controls">
                <h3>üè¢ ‰æõÊáâÂïÜË≥áÊñô</h3>
                <div class="search-container">
                    <button class="add-btn" onclick="addNewRow('suppliers')">
                        ‚ûï Êñ∞Â¢ûË≥áÊñô
                    </button>
                    <input type="text" id="suppliers-search" class="search-input" placeholder="üîç ÊêúÂ∞ã‰æõÊáâÂïÜË≥áÊñô..." onkeyup="searchTable('suppliers', this.value)">
                    <button class="clear-btn" onclick="clearSearch('suppliers')">Ê∏ÖÈô§</button>
                </div>
            </div>
            <div id="suppliers-table"></div>
        </div>
        
        <div id="reports" class="tab-content">
            <div class="controls">
                <h3>üìä Â†±Ë°®ÂàÜÊûê</h3>
                <div class="search-container">
                    <button class="add-btn" onclick="addNewRow('reports')">
                        ‚ûï Êñ∞Â¢ûË≥áÊñô
                    </button>
                    <input type="text" id="reports-search" class="search-input" placeholder="üîç ÊêúÂ∞ãÂ†±Ë°®Ë≥áÊñô..." onkeyup="searchTable('reports', this.value)">
                    <button class="clear-btn" onclick="clearSearch('reports')">Ê∏ÖÈô§</button>
                </div>
            </div>
            <div id="reports-table"></div>
        </div>
        
        <div id="settings" class="tab-content">
            <div class="controls">
                <h3>‚öôÔ∏è Á≥ªÁµ±Ë®≠ÂÆö</h3>
                <div class="search-container">
                    <button class="add-btn" onclick="addNewRow('settings')">
                        ‚ûï Êñ∞Â¢ûË≥áÊñô
                    </button>
                    <input type="text" id="settings-search" class="search-input" placeholder="üîç ÊêúÂ∞ãË®≠ÂÆöÈ†ÖÁõÆ..." onkeyup="searchTable('settings', this.value)">
                    <button class="clear-btn" onclick="clearSearch('settings')">Ê∏ÖÈô§</button>
                </div>
            </div>
            <div id="settings-table"></div>
        </div>
        
        <button class="export-btn" onclick="exportToExcel()">
            üìÅ ÂåØÂá∫ Excel Ê™îÊ°àÔºàÂê´Ê®£ÂºèÔºâ
        </button>
    </div>

    <script>
        // ÂÑ≤Â≠òÊâÄÊúâË°®Ê†ºÂØ¶‰æã
        let tables = {};
        let currentTabIndex = 0;
        let tabScrollOffset = 0;
        const tabWidth = 120;

        // Ê®°Êì¨Ë≥áÊñôÔºàÂä†ÂÖ•ÈéñÂÆöÂíåÂ§öË°åÂÖßÂÆπÁöÑÁØÑ‰æãÔºâ
        let salesData = [
            {id: 1, product: "Á≠ÜË®òÂûãÈõªËÖ¶", category: "3CÁî¢ÂìÅ", quantity: 25, price: 35000, total: 875000, status: "Â∑≤ÂÆåÊàê", date: "2024-01-15"},
            {id: 2, product: "ÊªëÈº†", category: "Âë®ÈÇäË®≠ÂÇô", quantity: 150, price: 500, total: 75000, status: "‰∏≠", date: "2024-02-10"},
            {id: 3, product: "ÈçµÁõ§\nÊ©üÊ¢∞Âºè\nÈùíËª∏", category: "Âë®ÈÇäË®≠ÂÇô", quantity: 80, price: 1200, total: 96000, status: "‰∏≠", date: "2024-02-20"},
            {id: 4, product: "È°ØÁ§∫Âô®", category: "3CÁî¢ÂìÅ", quantity: 45, price: 8000, total: 360000, status: "Â∑≤ÈÅéÊúü", date: "2024-03-05"},
            {id: 5, product: "Âç∞Ë°®Ê©ü\nHP LaserJet\nÈªëÁôΩÂàóÂç∞", category: "Ëæ¶ÂÖ¨Ë®≠ÂÇô", quantity: 12, price: 3000, total: 36000, status: "‰Ωé", date: "2024-03-15"}
        ];

        let inventoryData = [
            {id: 1, item: "A4 Á¥ôÂºµ", category: "Ëæ¶ÂÖ¨Áî®ÂìÅ", stock: 500, minStock: 100, location: "ÂÄâÂ∫´A", supplier: "ÊñáÂÖ∑ÂïÜË°å\nËÅØÁµ°‰∫∫ÔºöÁéãÂ∞èÊòé\nÈõªË©±Ôºö02-1234-5678", status: "ÂÖÖË∂≥"},
            {id: 2, item: "ÂéüÂ≠êÁ≠Ü", category: "ÊñáÂÖ∑", stock: 80, minStock: 50, location: "ÂÄâÂ∫´B", supplier: "Ëæ¶ÂÖ¨Áî®ÂìÅÂ∫ó", status: "Ê≠£Â∏∏"},
            {id: 3, item: "Ë≥áÊñôÂ§æ", category: "ÊñáÂÖ∑", stock: 25, minStock: 30, location: "ÂÄâÂ∫´A", supplier: "ÊñáÂÖ∑ÂïÜË°å", status: "ÂÅúÁî®"},
            {id: 4, item: "Ë®àÁÆóÊ©ü", category: "Ëæ¶ÂÖ¨Ë®≠ÂÇô", stock: 200, minStock: 50, location: "ÂÄâÂ∫´C", supplier: "ÈõªÂ≠êÁî®ÂìÅÂ∫ó\nÂ∞àÊ•≠Á∂≠‰øÆ\n‰øùÂõ∫‰∏ÄÂπ¥", status: "ÂÖÖË∂≥"},
            {id: 5, item: "Ê©°ÁöÆÊì¶", category: "ÊñáÂÖ∑", stock: 15, minStock: 20, location: "ÂÄâÂ∫´B", supplier: "ÊñáÂÖ∑ÂïÜË°å", status: "‰∏çË∂≥"}
        ];

        let employeesData = [
            {id: 1, name: "ÂºµÂ∞èÊòé", department: "Ë≥áË®äÈÉ®", position: "ËªüÈ´îÂ∑•Á®ãÂ∏´\nÂÖ®Á´ØÈñãÁôº\nJavaScriptÂ∞àÂÆ∂", salary: 55000, performance: "ÂÑ™ÁßÄ", joinDate: "2020-03-15", email: "ming@company.com"},
            {id: 2, name: "ÊùéÁæéÈ∫ó", department: "Ë°åÈä∑ÈÉ®", position: "Ë°åÈä∑Â∞àÂì°", salary: 48000, performance: "Â∑≤ÈÅéÊúü", joinDate: "2021-07-20", email: "mei@company.com"},
            {id: 3, name: "ÁéãÂ§ßËèØ", department: "Ë≤°ÂãôÈÉ®", position: "ÊúÉË®àÂ∏´", salary: 52000, performance: "ÂÑ™ÁßÄ", joinDate: "2019-11-10", email: "wang@company.com"},
            {id: 4, name: "Èô≥Â∞èËä±", department: "‰∫∫‰∫ãÈÉ®", position: "‰∫∫‰∫ãÂ∞àÂì°\nÊãõÂãüË≤†Ë≤¨‰∫∫\nÁ∏æÊïàÁÆ°ÁêÜ", salary: 45000, performance: "ÂÅúÁî®", joinDate: "2022-01-08", email: "chen@company.com"},
            {id: 5, name: "ÊûóÂøóÂº∑", department: "Ê•≠ÂãôÈÉ®", position: "Ê•≠ÂãôÁ∂ìÁêÜ", salary: 60000, performance: "ËâØÂ•Ω", joinDate: "2020-09-12", email: "lin@company.com"}
        ];

        let productsData = [
            {id: 1, name: "MacBook Pro", category: "Á≠ÜË®òÊú¨ÈõªËÖ¶", price: 55000, stock: 20, status: "ÁÜ±Èä∑"},
            {id: 2, name: "iPhone 15", category: "Êô∫ÊÖßÊâãÊ©ü", price: 32000, stock: 50, status: "ÁÜ±Èä∑"},
            {id: 3, name: "iPad Air", category: "Âπ≥ÊùøÈõªËÖ¶", price: 18000, stock: 30, status: "ÊôÆÈÄö"},
            {id: 4, name: "AirPods Pro", category: "ËÄ≥Ê©ü", price: 7500, stock: 100, status: "ÁÜ±Èä∑"},
            {id: 5, name: "Apple Watch", category: "Êô∫ÊÖßÊâãÈå∂", price: 12000, stock: 25, status: "ÊôÆÈÄö"}
        ];

        let customersData = [
            {id: 1, name: "Âè∞Á©çÈõª", contact: "ÂºµÁ∂ìÁêÜ", phone: "02-1234-5678", email: "tsmc@company.com", level: "VIP"},
            {id: 2, name: "È¥ªÊµ∑ÁßëÊäÄ", contact: "Êùé‰∏ª‰ªª", phone: "03-2345-6789", email: "foxconn@company.com", level: "VIP"},
            {id: 3, name: "ËÅØÁôºÁßë", contact: "ÁéãÂçîÁêÜ", phone: "03-3456-7890", email: "mediatek@company.com", level: "ÈáëÁâå"},
            {id: 4, name: "ËèØÁ¢©ÈõªËÖ¶", contact: "Èô≥Á∏ΩÁõ£", phone: "02-4567-8901", email: "asus@company.com", level: "ÈáëÁâå"},
            {id: 5, name: "ÂÆèÁ¢ÅÈõÜÂúò", contact: "ÊûóÂâØÁ∏Ω", phone: "02-5678-9012", email: "acer@company.com", level: "ÈäÄÁâå"}
        ];

        let ordersData = [
            {id: "ORD001", customer: "Âè∞Á©çÈõª", product: "MacBook Pro", quantity: 10, amount: 550000, status: "Â∑≤ÂÆåÊàê", date: "2024-05-15"},
            {id: "ORD002", customer: "È¥ªÊµ∑ÁßëÊäÄ", product: "iPhone 15", quantity: 25, amount: 800000, status: "ËôïÁêÜ‰∏≠", date: "2024-05-20"},
            {id: "ORD003", customer: "ËÅØÁôºÁßë", product: "iPad Air", quantity: 15, amount: 270000, status: "Â∑≤ÂÆåÊàê", date: "2024-05-18"},
            {id: "ORD004", customer: "ËèØÁ¢©ÈõªËÖ¶", product: "AirPods Pro", quantity: 50, amount: 375000, status: "ÂæÖÂá∫Ë≤®", date: "2024-05-22"},
            {id: "ORD005", customer: "ÂÆèÁ¢ÅÈõÜÂúò", product: "Apple Watch", quantity: 20, amount: 240000, status: "ËôïÁêÜ‰∏≠", date: "2024-05-25"}
        ];

        let suppliersData = [
            {id: 1, name: "ËòãÊûúÂè∞ÁÅ£", contact: "ÁæéÂúãÁ∏ΩÈÉ®", phone: "+1-408-996-1010", products: "AppleÁî¢ÂìÅ", rating: "A+"},
            {id: 2, name: "‰∏âÊòüÈõªÂ≠ê", contact: "ÈüìÂúãÁ∏ΩÈÉ®", phone: "+82-2-2255-0114", products: "AndroidË®≠ÂÇô", rating: "A"},
            {id: 3, name: "ËÅØÊÉ≥ÈõÜÂúò", contact: "‰∏≠ÂúãÁ∏ΩÈÉ®", phone: "+86-10-5886-8888", products: "ThinkPadÁ≥ªÂàó", rating: "B+"},
            {id: 4, name: "Êà¥ÁàæÁßëÊäÄ", contact: "ÁæéÂúãÁ∏ΩÈÉ®", phone: "+1-512-338-4400", products: "ÂïÜÁî®ÈõªËÖ¶", rating: "A-"},
            {id: 5, name: "ÊÉ†ÊôÆ‰ºÅÊ•≠", contact: "ÁæéÂúãÁ∏ΩÈÉ®", phone: "+1-650-857-1501", products: "‰ºÅÊ•≠Ëß£Ê±∫ÊñπÊ°à", rating: "B+"}
        ];

        let reportsData = [
            {id: 1, name: "ÊúàÂ∫¶Èä∑ÂîÆÂ†±Ë°®", type: "Èä∑ÂîÆÂàÜÊûê", lastUpdate: "2024-05-30", status: "ÊúÄÊñ∞", size: "2.5MB"},
            {id: 2, name: "Â∫´Â≠òÈÄ±Â†±", type: "Â∫´Â≠òÁÆ°ÁêÜ", lastUpdate: "2024-05-28", status: "ÊúÄÊñ∞", size: "1.8MB"},
            {id: 3, name: "ÂÆ¢Êà∂ÊªøÊÑèÂ∫¶Ë™øÊü•", type: "ÂÆ¢Êà∂ÂàÜÊûê", lastUpdate: "2024-05-25", status: "ÈúÄÊõ¥Êñ∞", size: "3.2MB"},
            {id: 4, name: "‰æõÊáâÂïÜÁ∏æÊïàË©ï‰º∞", type: "‰æõÊáâÈèà", lastUpdate: "2024-05-20", status: "ÈúÄÊõ¥Êñ∞", size: "4.1MB"},
            {id: 5, name: "Ë≤°ÂãôÂ≠£Â†±", type: "Ë≤°ÂãôÂàÜÊûê", lastUpdate: "2024-05-15", status: "Â∑≤ÈÅéÊúü", size: "5.6MB"}
        ];

        let settingsData = [
            {id: 1, module: "‰ΩøÁî®ËÄÖÁÆ°ÁêÜ", setting: "ÂØÜÁ¢ºÊîøÁ≠ñ", value: "8‰ΩçÊï∏+ÁâπÊÆäÂ≠óÂÖÉ", status: "ÂïüÁî®"},
            {id: 2, module: "Á≥ªÁµ±ÂÆâÂÖ®", setting: "ÁôªÂÖ•ÈÄæÊôÇ", value: "30ÂàÜÈêò", status: "ÂïüÁî®"},
            {id: 3, module: "Ë≥áÊñôÂÇô‰ªΩ", setting: "Ëá™ÂãïÂÇô‰ªΩ", value: "ÊØèÊó•ÂáåÊô®2Èªû", status: "ÂïüÁî®"},
            {id: 4, module: "ÈÉµ‰ª∂ÈÄöÁü•", setting: "Ë®ÇÂñÆÊèêÈÜí", value: "Âç≥ÊôÇÈÄöÁü•", status: "ÂÅúÁî®"},
            {id: 5, module: "Â†±Ë°®Ë®≠ÂÆö", setting: "ÂåØÂá∫Ê†ºÂºè", value: "Excel + PDF", status: "ÂïüÁî®"}
        ];

        // Áç≤ÂèñË≥áÊñôÈô£ÂàóÁöÑÂáΩÊï∏
        function getDataArray(tableName) {
            const dataMap = {
                sales: salesData,
                inventory: inventoryData,
                employees: employeesData,
                products: productsData,
                customers: customersData,
                orders: ordersData,
                suppliers: suppliersData,
                reports: reportsData,
                settings: settingsData
            };
            return dataMap[tableName] || [];
        }

        // Ê®°Êì¨ API Ë´ãÊ±Ç
        async function apiRequest(method, endpoint, data = null) {
            await new Promise(resolve => setTimeout(resolve, 200));
            
            try {
                if (method === 'POST' && data) {
                    const newData = { ...data, id: Date.now() };
                    return { success: true, data: newData };
                } else if (method === 'PUT' && data) {
                    return { success: true, data: data };
                } else if (method === 'DELETE') {
                    return { success: true };
                }
                
                return { success: true, data: null };
            } catch (error) {
                return { success: false, error: error.message };
            }
        }

        // Ê¨äÈôêÊ™¢Êü•ÂáΩÊï∏ÔºàÂä†Âº∑ÁâàÔºâ
        function checkPermission(rowData, action) {
            // ÂÆöÁæ©ÂèóÈôêÂà∂ÁöÑÁãÄÊÖãÔºàÈÄô‰∫õÁãÄÊÖãÊúÉË¢´ÈéñÂÆöÔºâ
            const restrictedStatuses = ['Â∑≤ÂÆåÊàê', 'Â∑≤ÈÅéÊúü', 'ÂÅúÁî®'];
            const status = rowData.status || rowData.performance || rowData.level;
            
            if (action === 'edit' || action === 'delete') {
                return !restrictedStatuses.includes(status);
            }
            
            return true; // Ë§áË£ΩÂäüËÉΩ‰∏ÄËà¨ÈÉΩÂÖÅË®±
        }

        // Ê™¢Êü•ÁâπÂÆöÊ¨Ñ‰ΩçÊòØÂê¶ÂèØÁ∑®ËºØ
        function isFieldEditable(rowData, fieldName) {
            const restrictedStatuses = ['Â∑≤ÂÆåÊàê', 'Â∑≤ÈÅéÊúü', 'ÂÅúÁî®'];
            const status = rowData.status || rowData.performance || rowData.level;
            
            // Â¶ÇÊûúÊï¥Ë°åÈÉΩË¢´ÈéñÂÆöÔºåÂâáÊâÄÊúâÊ¨Ñ‰ΩçÈÉΩ‰∏çÂèØÁ∑®ËºØ
            if (restrictedStatuses.includes(status)) {
                return false;
            }
            
            // ÁâπÂÆöÊ¨Ñ‰ΩçÁöÑÈ°çÂ§ñÈôêÂà∂Ôºà‰æãÂ¶ÇÔºöID Ê∞∏ÈÅ†‰∏çÂèØÁ∑®ËºØÔºâ
            const alwaysReadOnlyFields = ['id'];
            if (alwaysReadOnlyFields.includes(fieldName)) {
                return false;
            }
            
            return true;
        }

        // ÂâµÂª∫ÂäüËÉΩÊ¨Ñ‰Ωç
        function createActionColumn(tableName) {
            return {
                title: "ÂäüËÉΩ",
                field: "actions",
                width: 200,
                hozAlign: "center",
                headerSort: false,
                cellClick: function(e, cell) {
                    e.stopPropagation();
                },
                formatter: function(cell, formatterParams) {
                    const rowData = cell.getRow().getData();
                    const canEdit = checkPermission(rowData, 'edit');
                    const canDelete = checkPermission(rowData, 'delete');
                    
                    const permissionIcon = (canEdit && canDelete) ? 
                        '<i class="action-icon permission-icon unlocked" title="ÂèØÁ∑®ËºØ">üîì</i>' : 
                        '<i class="action-icon permission-icon locked" title="ÂÉÖËÆÄÂèñ">üîí</i>';
                    
                    const editIcon = canEdit ? 
                        '<i class="action-icon edit-icon enabled" title="‰øÆÊîπ" onclick="editRow(\'' + tableName + '\', ' + JSON.stringify(rowData.id) + ')">‚úèÔ∏è</i>' :
                        '<i class="action-icon edit-icon disabled" title="ÁÑ°Ê≥ï‰øÆÊîπ">‚úèÔ∏è</i>';
                    
                    const deleteIcon = canDelete ? 
                        '<i class="action-icon delete-icon enabled" title="Âà™Èô§" onclick="deleteRow(\'' + tableName + '\', ' + JSON.stringify(rowData.id) + ')">üóëÔ∏è</i>' :
                        '<i class="action-icon delete-icon disabled" title="ÁÑ°Ê≥ïÂà™Èô§">üóëÔ∏è</i>';
                    
                    const copyIcon = '<i class="action-icon copy-icon enabled" title="Ë§áË£Ω" onclick="copyRow(\'' + tableName + '\', ' + JSON.stringify(rowData.id) + ')">üìã</i>';
                    
                    return `<div class="action-buttons">
                        ${permissionIcon}
                        ${editIcon}
                        ${deleteIcon}
                        ${copyIcon}
                    </div>`;
                }
            };
        }

        // Ëá™ÂãïË™øÊï¥Ë°åÈ´òÁöÑÂáΩÊï∏
        function autoResizeRows(table) {
            if (!table) return;
            
            setTimeout(() => {
                const rows = table.getRows();
                rows.forEach(row => {
                    const cells = row.getCells();
                    let maxLines = 1;
                    
                    cells.forEach(cell => {
                        const value = cell.getValue();
                        if (typeof value === 'string' && value.includes('\n')) {
                            const lines = value.split('\n').length;
                            maxLines = Math.max(maxLines, lines);
                        }
                    });
                    
                    // Ë®≠ÂÆöË°åÈ´ò
                    const minHeight = Math.max(40, maxLines * 20 + 16);
                    const rowElement = row.getElement();
                    if (rowElement) {
                        rowElement.style.height = minHeight + 'px';
                    }
                });
            }, 100);
        }
        function multilineEditor(cell, onRendered, success, cancel, editorParams) {
            const editor = document.createElement("textarea");
            editor.style.padding = "4px";
            editor.style.width = "100%";
            editor.style.height = "80px";
            editor.style.resize = "vertical";
            editor.style.boxSizing = "border-box";
            editor.style.border = "1px solid #ccc";
            editor.style.borderRadius = "3px";
            editor.value = cell.getValue() || "";

            onRendered(function() {
                editor.focus();
                editor.style.height = "80px";
            });

            function successFunc() {
                success(editor.value);
            }

            editor.addEventListener("blur", successFunc);
            editor.addEventListener("keydown", function(e) {
                if (e.keyCode == 13 && e.ctrlKey) {
                    successFunc();
                }
                if (e.keyCode == 27) {
                    cancel();
                }
            });

            return editor;
        }

        // Â§öË°åÊñáÂ≠óÊ†ºÂºèÂåñÂô®ÔºàÂä†Âº∑ÁâàÔºâ
        function multilineFormatter(cell, formatterParams) {
            const value = cell.getValue();
            const rowData = cell.getRow().getData();
            const field = cell.getColumn().getField();
            
            // Ê™¢Êü•ÊòØÂê¶ÁÇ∫ÈéñÂÆöÁãÄÊÖã
            if (!isFieldEditable(rowData, field)) {
                cell.getElement().classList.add('locked-cell');
            }
            
            if (typeof value === 'string' && value.includes('\n')) {
                const lines = value.split('\n');
                const lineCount = lines.length;
                
                // Ëá™ÂãïË™øÊï¥Ë°åÈ´ò
                setTimeout(() => {
                    const rowElement = cell.getRow().getElement();
                    const minHeight = Math.max(40, lineCount * 20 + 16);
                    rowElement.style.height = minHeight + 'px';
                }, 10);
                
                return '<div class="multiline-cell">' + value.replace(/\n/g, '<br>') + '</div>';
            }
            return value || '';
        }

        // Êô∫ËÉΩÁ∑®ËºØÂô®ÔºàÊ†πÊìöÂÖßÂÆπËá™ÂãïÈÅ∏ÊìáÔºâ
        function smartEditor(cell, onRendered, success, cancel, editorParams) {
            const rowData = cell.getRow().getData();
            const field = cell.getColumn().getField();
            const currentValue = cell.getValue() || "";
            
            // Ê™¢Êü•ÊòØÂê¶ÂèØÁ∑®ËºØ
            if (!isFieldEditable(rowData, field)) {
                // È°ØÁ§∫ÈéñÂÆöÊèêÁ§∫
                showMessage('Ê≠§Ê¨Ñ‰ΩçÂ∑≤Ë¢´ÈéñÂÆöÔºåÁÑ°Ê≥ïÁ∑®ËºØ', 'warning');
                cancel();
                return;
            }
            
            // Â¶ÇÊûúÂÖßÂÆπÂåÖÂê´ÊèõË°åÁ¨¶ÊàñË∂ÖÈÅé30Â≠óÂÖÉÔºå‰ΩøÁî®Â§öË°åÁ∑®ËºØÂô®
            if (currentValue.includes('\n') || currentValue.length > 30) {
                return multilineEditor(cell, onRendered, success, cancel, editorParams);
            } else {
                // ‰ΩøÁî®ÂñÆË°åÁ∑®ËºØÂô®
                const editor = document.createElement("input");
                editor.setAttribute("type", "text");
                editor.style.padding = "4px";
                editor.style.width = "100%";
                editor.style.boxSizing = "border-box";
                editor.style.border = "1px solid #ccc";
                editor.style.borderRadius = "3px";
                editor.value = currentValue;

                onRendered(function() {
                    editor.focus();
                    editor.select();
                });

                function successFunc() {
                    success(editor.value);
                }

                editor.addEventListener("blur", successFunc);
                editor.addEventListener("keydown", function(e) {
                    if (e.keyCode == 13) {
                        successFunc();
                    }
                    if (e.keyCode == 27) {
                        cancel();
                    }
                });

                return editor;
            }
        }

        // Êñ∞Â¢ûË≥áÊñôÂäüËÉΩ
        async function addNewRow(tableName) {
            const table = tables[tableName];
            if (!table) return;

            const newData = createDefaultRowData(tableName);
            
            try {
                const result = await apiRequest('POST', '/' + tableName, newData);
                
                if (result.success) {
                    const createdData = result.data;
                    // Êõ¥Êñ∞Â∞çÊáâÁöÑË≥áÊñôÈô£Âàó
                    const dataArray = getDataArray(tableName);
                    dataArray.unshift(createdData);
                    
                    table.addData([createdData], true);
                    showMessage('Êñ∞Â¢ûÊàêÂäüÔºÅ', 'success');
                } else {
                    showMessage('Êñ∞Â¢ûÂ§±ÊïóÔºö' + result.error, 'error');
                }
            } catch (error) {
                console.error('Add row error:', error);
                showMessage('Êñ∞Â¢ûÈÅéÁ®ã‰∏≠ÁôºÁîüÈåØË™§', 'error');
            }
        }

        // ÂâµÂª∫È†êË®≠Ë≥áÊñô
        function createDefaultRowData(tableName) {
            const dataArray = getDataArray(tableName);
            const getNextId = () => {
                const maxId = Math.max(...dataArray.map(item => typeof item.id === 'number' ? item.id : 0));
                return maxId + 1;
            };

            const defaultData = {
                sales: {
                    id: getNextId(),
                    product: "Êñ∞Áî¢ÂìÅ",
                    category: "3CÁî¢ÂìÅ", 
                    quantity: 1,
                    price: 0,
                    total: 0,
                    status: "‰∏≠",
                    date: new Date().toISOString().slice(0, 10)
                },
                inventory: {
                    id: getNextId(),
                    item: "Êñ∞ÂìÅÈ†Ö",
                    category: "Ëæ¶ÂÖ¨Áî®ÂìÅ",
                    stock: 0,
                    minStock: 10,
                    location: "ÂÄâÂ∫´A",
                    supplier: "‰æõÊáâÂïÜ",
                    status: "Ê≠£Â∏∏"
                },
                employees: {
                    id: getNextId(),
                    name: "Êñ∞Âì°Â∑•",
                    department: "Ë≥áË®äÈÉ®",
                    position: "ËÅ∑Âì°",
                    salary: 30000,
                    performance: "ÊôÆÈÄö",
                    joinDate: new Date().toISOString().slice(0, 10),
                    email: "email@company.com"
                },
                products: {
                    id: getNextId(),
                    name: "Êñ∞Áî¢ÂìÅ",
                    category: "ÈõªÂ≠êÁî¢ÂìÅ",
                    price: 0,
                    stock: 0,
                    status: "ÊôÆÈÄö"
                },
                customers: {
                    id: getNextId(),
                    name: "Êñ∞ÂÆ¢Êà∂",
                    contact: "ËÅØÁµ°‰∫∫",
                    phone: "ÈõªË©±ËôüÁ¢º",
                    email: "email@company.com",
                    level: "ÈäÄÁâå"
                },
                orders: {
                    id: "ORD" + Date.now().toString().slice(-6),
                    customer: "ÂÆ¢Êà∂ÂêçÁ®±",
                    product: "Áî¢ÂìÅÂêçÁ®±",
                    quantity: 1,
                    amount: 0,
                    status: "ËôïÁêÜ‰∏≠",
                    date: new Date().toISOString().slice(0, 10)
                },
                suppliers: {
                    id: getNextId(),
                    name: "Êñ∞‰æõÊáâÂïÜ",
                    contact: "ËÅØÁµ°Ëôï",
                    phone: "ÈõªË©±ËôüÁ¢º",
                    products: "Áî¢ÂìÅË™™Êòé",
                    rating: "B"
                },
                reports: {
                    id: getNextId(),
                    name: "Êñ∞Â†±Ë°®",
                    type: "ÂàÜÊûêÂ†±Ë°®",
                    lastUpdate: new Date().toISOString().slice(0, 10),
                    status: "ÈúÄÊõ¥Êñ∞",
                    size: "0MB"
                },
                settings: {
                    id: getNextId(),
                    module: "Êñ∞Ê®°ÁµÑ",
                    setting: "Ë®≠ÂÆöÈ†ÖÁõÆ",
                    value: "Ë®≠ÂÆöÂÄº",
                    status: "ÂÅúÁî®"
                }
            };

            return defaultData[tableName] || {};
        }

        // ‰øÆÊîπË≥áÊñôÂäüËÉΩ
        async function editRow(tableName, rowId) {
            const table = tables[tableName];
            if (!table) return;

            const row = table.getRow(rowId);
            const rowData = row.getData();
            
            if (!checkPermission(rowData, 'edit')) {
                showMessage('Ê≠§Ë≥áÊñôÁÑ°Ê≥ï‰øÆÊîπ', 'warning');
                return;
            }

            // ËÆìË©≤Ë°åÈÄ≤ÂÖ•Á∑®ËºØÊ®°Âºè
            const cells = row.getCells();
            cells.forEach(cell => {
                const column = cell.getColumn();
                const field = column.getField();
                
                if (field !== 'id' && field !== 'actions') {
                    cell.edit();
                }
            });
        }

        // ÂÑ≤Â≠ò‰øÆÊîπÁöÑË≥áÊñô
        async function saveRowData(tableName, rowData) {
            try {
                const result = await apiRequest('PUT', '/' + tableName + '/' + rowData.id, rowData);
                
                if (result.success) {
                    // Êõ¥Êñ∞Â∞çÊáâÁöÑË≥áÊñôÈô£Âàó
                    const dataArray = getDataArray(tableName);
                    const index = dataArray.findIndex(item => item.id === rowData.id);
                    if (index !== -1) {
                        dataArray[index] = rowData;
                    }
                    
                    showMessage('‰øÆÊîπÊàêÂäüÔºÅ', 'success');
                    return result.data;
                } else {
                    showMessage('‰øÆÊîπÂ§±ÊïóÔºö' + result.error, 'error');
                    return false;
                }
            } catch (error) {
                console.error('Save row error:', error);
                showMessage('ÂÑ≤Â≠òÈÅéÁ®ã‰∏≠ÁôºÁîüÈåØË™§', 'error');
                return false;
            }
        }

        // Âà™Èô§Ë≥áÊñôÂäüËÉΩ
        async function deleteRow(tableName, rowId) {
            const table = tables[tableName];
            if (!table) return;

            const row = table.getRow(rowId);
            const rowData = row.getData();
            
            if (!checkPermission(rowData, 'delete')) {
                showMessage('Ê≠§Ë≥áÊñôÁÑ°Ê≥ïÂà™Èô§', 'warning');
                return;
            }

            if (!confirm('Á¢∫ÂÆöË¶ÅÂà™Èô§ÈÄôÁ≠ÜË≥áÊñôÂóéÔºüÊ≠§Êìç‰ΩúÁÑ°Ê≥ïÂæ©Âéü„ÄÇ')) {
                return;
            }

            try {
                const result = await apiRequest('DELETE', '/' + tableName + '/' + rowId);
                
                if (result.success) {
                    // ÂæûË≥áÊñôÈô£Âàó‰∏≠ÁßªÈô§
                    const dataArray = getDataArray(tableName);
                    const index = dataArray.findIndex(item => item.id === rowId);
                    if (index !== -1) {
                        dataArray.splice(index, 1);
                    }
                    
                    row.delete();
                    showMessage('Âà™Èô§ÊàêÂäüÔºÅ', 'success');
                } else {
                    showMessage('Âà™Èô§Â§±ÊïóÔºö' + result.error, 'error');
                }
            } catch (error) {
                console.error('Delete row error:', error);
                showMessage('Âà™Èô§ÈÅéÁ®ã‰∏≠ÁôºÁîüÈåØË™§', 'error');
            }
        }

        // Ë§áË£ΩË≥áÊñôÂäüËÉΩ
        async function copyRow(tableName, rowId) {
            const table = tables[tableName];
            if (!table) return;

            const row = table.getRow(rowId);
            const originalData = row.getData();
            
            const copiedData = { ...originalData };
            delete copiedData.id;
            
            if (copiedData.name) {
                copiedData.name = copiedData.name + " (ÂâØÊú¨)";
            } else if (copiedData.product) {
                copiedData.product = copiedData.product + " (ÂâØÊú¨)";
            } else if (copiedData.item) {
                copiedData.item = copiedData.item + " (ÂâØÊú¨)";
            }

            try {
                const result = await apiRequest('POST', '/' + tableName, copiedData);
                
                if (result.success) {
                    const createdData = result.data;
                    
                    // Êõ¥Êñ∞Â∞çÊáâÁöÑË≥áÊñôÈô£Âàó
                    const dataArray = getDataArray(tableName);
                    dataArray.unshift(createdData);
                    
                    table.addData([createdData], true);
                    showMessage('Ë§áË£ΩÊàêÂäüÔºÅ', 'success');
                } else {
                    showMessage('Ë§áË£ΩÂ§±ÊïóÔºö' + result.error, 'error');
                }
            } catch (error) {
                console.error('Copy row error:', error);
                showMessage('Ë§áË£ΩÈÅéÁ®ã‰∏≠ÁôºÁîüÈåØË™§', 'error');
            }
        }

        // È°ØÁ§∫Ë®äÊÅØ
        function showMessage(message, type = 'info') {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message message-${type}`;
            messageDiv.textContent = message;
            
            Object.assign(messageDiv.style, {
                position: 'fixed',
                top: '20px',
                right: '20px',
                padding: '12px 20px',
                borderRadius: '5px',
                color: 'white',
                fontWeight: 'bold',
                zIndex: '9999',
                opacity: '0',
                transition: 'opacity 0.3s ease'
            });

            const colors = {
                success: '#28a745',
                error: '#dc3545', 
                warning: '#ffc107',
                info: '#17a2b8'
            };
            messageDiv.style.backgroundColor = colors[type] || colors.info;

            document.body.appendChild(messageDiv);
            
            setTimeout(() => {
                messageDiv.style.opacity = '1';
            }, 100);

            setTimeout(() => {
                messageDiv.style.opacity = '0';
                setTimeout(() => {
                    if (messageDiv.parentNode) {
                        messageDiv.parentNode.removeChild(messageDiv);
                    }
                }, 300);
            }, 3000);
        }

        // ÂàùÂßãÂåñË°®Ê†º
        function initTables() {
            // Èä∑ÂîÆË°®Ê†º
            tables.sales = new Tabulator("#sales-table", {
                data: salesData,
                layout: "fitColumns",
                pagination: "local",
                paginationSize: 10,
                movableColumns: true,
                resizableRows: true,
                cellEdited: function(cell) {
                    const table = cell.getTable();
                    autoResizeRows(table);
                },
                columns: [
                    {title: "ID", field: "id", width: 80, hozAlign: "center", sorter: "number", headerFilter: "input"},
                    {title: "Áî¢ÂìÅÂêçÁ®±", field: "product", width: 150, sorter: "string", headerFilter: "input", editor: smartEditor, formatter: multilineFormatter},
                    {title: "ÂàÜÈ°û", field: "category", width: 120, sorter: "string", headerFilter: "select", headerFilterParams: {values: ["", "3CÁî¢ÂìÅ", "Âë®ÈÇäË®≠ÂÇô", "Ëæ¶ÂÖ¨Ë®≠ÂÇô"]}, editor: "select", editorParams: {values: ["3CÁî¢ÂìÅ", "Âë®ÈÇäË®≠ÂÇô", "Ëæ¶ÂÖ¨Ë®≠ÂÇô"]}},
                    {title: "Êï∏Èáè", field: "quantity", width: 100, hozAlign: "right", sorter: "number", headerFilter: "number", editor: "number"},
                    {title: "ÂñÆÂÉπ", field: "price", width: 120, hozAlign: "right", formatter: "money", formatterParams: {symbol: "NT$"}, sorter: "number", headerFilter: "number", editor: "number"},
                    {title: "Á∏ΩÈáëÈ°ç", field: "total", width: 150, hozAlign: "right", formatter: "money", formatterParams: {symbol: "NT$"}, sorter: "number", headerFilter: "number", editor: "number"},
                    {title: "ÁãÄÊÖã", field: "status", width: 100, hozAlign: "center", sorter: "string", headerFilter: "select", headerFilterParams: {values: ["", "È´ò", "‰∏≠", "‰Ωé", "Â∑≤ÂÆåÊàê", "Â∑≤ÈÅéÊúü"]}, editor: "select", editorParams: {values: ["È´ò", "‰∏≠", "‰Ωé", "Â∑≤ÂÆåÊàê", "Â∑≤ÈÅéÊúü"]},
                     formatter: function(cell) {
                         const value = cell.getValue();
                         const rowData = cell.getRow().getData();
                         let className = "";
                         
                         // Ê™¢Êü•ÊòØÂê¶ÁÇ∫ÈéñÂÆöÁãÄÊÖã
                         if (!isFieldEditable(rowData, 'status')) {
                             cell.getElement().classList.add('locked-cell');
                         }
                         
                         switch(value) {
                             case "È´ò": className = "high-value"; break;
                             case "‰∏≠": className = "medium-value"; break;
                             case "‰Ωé": className = "low-value"; break;
                             case "Â∑≤ÂÆåÊàê": className = "high-value"; break;
                             case "Â∑≤ÈÅéÊúü": className = "low-value"; break;
                         }
                         return `<span class="${className}">${value}</span>`;
                     }
                    },
                    {title: "Êó•Êúü", field: "date", width: 120, hozAlign: "center", sorter: "date", headerFilter: "input", editor: "date"},
                    createActionColumn('sales')
                ]
            });

            // Â∫´Â≠òË°®Ê†º
            tables.inventory = new Tabulator("#inventory-table", {
                data: inventoryData,
                layout: "fitColumns",
                pagination: "local",
                paginationSize: 10,
                movableColumns: true,
                resizableRows: true,
                cellEdited: function(cell) {
                    const rowData = cell.getRow().getData();
                    saveRowData('inventory', rowData);
                    // Á∑®ËºØÂæåÈáçÊñ∞Ë™øÊï¥Ë°åÈ´ò
                    autoResizeRows(tables.inventory);
                },
                columns: [
                    {title: "ID", field: "id", width: 80, hozAlign: "center", sorter: "number", headerFilter: "input"},
                    {title: "ÂìÅÈ†Ö", field: "item", width: 150, sorter: "string", headerFilter: "input", editor: smartEditor, formatter: multilineFormatter},
                    {title: "ÂàÜÈ°û", field: "category", width: 120, sorter: "string", headerFilter: "select", headerFilterParams: {values: ["", "Ëæ¶ÂÖ¨Áî®ÂìÅ", "ÊñáÂÖ∑", "Ëæ¶ÂÖ¨Ë®≠ÂÇô"]}, editor: "select", editorParams: {values: ["Ëæ¶ÂÖ¨Áî®ÂìÅ", "ÊñáÂÖ∑", "Ëæ¶ÂÖ¨Ë®≠ÂÇô"]}},
                    {title: "ÁèæÊúâÂ∫´Â≠ò", field: "stock", width: 120, hozAlign: "right", sorter: "number", headerFilter: "number", editor: "number"},
                    {title: "ÊúÄ‰ΩéÂ∫´Â≠ò", field: "minStock", width: 120, hozAlign: "right", sorter: "number", headerFilter: "number", editor: "number"},
                    {title: "‰ΩçÁΩÆ", field: "location", width: 100, hozAlign: "center", sorter: "string", headerFilter: "select", headerFilterParams: {values: ["", "ÂÄâÂ∫´A", "ÂÄâÂ∫´B", "ÂÄâÂ∫´C"]}, editor: "select", editorParams: {values: ["ÂÄâÂ∫´A", "ÂÄâÂ∫´B", "ÂÄâÂ∫´C"]}},
                    {title: "‰æõÊáâÂïÜ", field: "supplier", width: 140, sorter: "string", headerFilter: "input", editor: smartEditor, formatter: multilineFormatter},
                    {title: "ÁãÄÊÖã", field: "status", width: 100, hozAlign: "center", sorter: "string", headerFilter: "select", headerFilterParams: {values: ["", "ÂÖÖË∂≥", "Ê≠£Â∏∏", "‰∏çË∂≥", "ÂÅúÁî®"]}, editor: "select", editorParams: {values: ["ÂÖÖË∂≥", "Ê≠£Â∏∏", "‰∏çË∂≥", "ÂÅúÁî®"]},
                     formatter: function(cell) {
                         const value = cell.getValue();
                         const rowData = cell.getRow().getData();
                         let className = "";
                         
                         // Ê™¢Êü•ÊòØÂê¶ÁÇ∫ÈéñÂÆöÁãÄÊÖã
                         if (!isFieldEditable(rowData, 'status')) {
                             cell.getElement().classList.add('locked-cell');
                         }
                         
                         switch(value) {
                             case "ÂÖÖË∂≥": className = "high-value"; break;
                             case "Ê≠£Â∏∏": className = "medium-value"; break;
                             case "‰∏çË∂≥": className = "low-value"; break;
                             case "ÂÅúÁî®": className = "low-value"; break;
                         }
                         return `<span class="${className}">${value}</span>`;
                     }
                    },
                    createActionColumn('inventory')
                ]
            });
            
            // Âì°Â∑•Ë°®Ê†º
            tables.employees = new Tabulator("#employees-table", {
                data: employeesData,
                layout: "fitColumns",
                pagination: "local",
                paginationSize: 10,
                movableColumns: true,
                resizableRows: true,
                cellEdited: function(cell) {
                    const rowData = cell.getRow().getData();
                    saveRowData('employees', rowData);
                },
                columns: [
                    {title: "ID", field: "id", width: 80, hozAlign: "center", sorter: "number", headerFilter: "input"},
                    {title: "ÂßìÂêç", field: "name", width: 120, sorter: "string", headerFilter: "input", editor: "input"},
                    {title: "ÈÉ®ÈñÄ", field: "department", width: 120, hozAlign: "center", sorter: "string", headerFilter: "select", headerFilterParams: {values: ["", "Ë≥áË®äÈÉ®", "Ë°åÈä∑ÈÉ®", "Ë≤°ÂãôÈÉ®", "‰∫∫‰∫ãÈÉ®", "Ê•≠ÂãôÈÉ®"]}, editor: "select", editorParams: {values: ["Ë≥áË®äÈÉ®", "Ë°åÈä∑ÈÉ®", "Ë≤°ÂãôÈÉ®", "‰∫∫‰∫ãÈÉ®", "Ê•≠ÂãôÈÉ®"]}},
                    {title: "ËÅ∑‰Ωç", field: "position", width: 140, sorter: "string", headerFilter: "input", editor: multilineEditor, formatter: multilineFormatter},
                    {title: "Ëñ™Ë≥á", field: "salary", width: 120, hozAlign: "right", formatter: "money", formatterParams: {symbol: "NT$"}, sorter: "number", headerFilter: "number", editor: "number"},
                    {title: "Á∏æÊïà", field: "performance", width: 100, hozAlign: "center", sorter: "string", headerFilter: "select", headerFilterParams: {values: ["", "ÂÑ™ÁßÄ", "ËâØÂ•Ω", "ÊôÆÈÄö"]}, editor: "select", editorParams: {values: ["ÂÑ™ÁßÄ", "ËâØÂ•Ω", "ÊôÆÈÄö"]},
                     formatter: function(cell) {
                         const value = cell.getValue();
                         let className = "";
                         switch(value) {
                             case "ÂÑ™ÁßÄ": className = "high-value"; break;
                             case "ËâØÂ•Ω": className = "medium-value"; break;
                             case "ÊôÆÈÄö": className = "low-value"; break;
                         }
                         return `<span class="${className}">${value}</span>`;
                     }
                    },
                    {title: "Âà∞ËÅ∑Êó•Êúü", field: "joinDate", width: 120, hozAlign: "center", sorter: "date", headerFilter: "input", editor: "date"},
                    {title: "Email", field: "email", width: 180, sorter: "string", headerFilter: "input", editor: "input"},
                    createActionColumn('employees')
                ]
            });
            
            // Áî¢ÂìÅË°®Ê†º
            tables.products = new Tabulator("#products-table", {
                data: productsData,
                layout: "fitColumns",
                pagination: "local",
                paginationSize: 10,
                movableColumns: true,
                resizableRows: true,
                cellEdited: function(cell) {
                    const rowData = cell.getRow().getData();
                    saveRowData('products', rowData);
                },
                columns: [
                    {title: "ID", field: "id", width: 80, hozAlign: "center", sorter: "number", headerFilter: "input"},
                    {title: "Áî¢ÂìÅÂêçÁ®±", field: "name", width: 200, sorter: "string", headerFilter: "input", editor: "input"},
                    {title: "ÂàÜÈ°û", field: "category", width: 150, sorter: "string", headerFilter: "input", editor: multilineEditor, formatter: multilineFormatter},
                    {title: "ÂÉπÊ†º", field: "price", width: 120, hozAlign: "right", formatter: "money", formatterParams: {symbol: "NT$"}, sorter: "number", headerFilter: "number", editor: "number"},
                    {title: "Â∫´Â≠ò", field: "stock", width: 100, hozAlign: "right", sorter: "number", headerFilter: "number", editor: "number"},
                    {title: "ÁãÄÊÖã", field: "status", width: 100, hozAlign: "center", sorter: "string", headerFilter: "select", headerFilterParams: {values: ["", "ÁÜ±Èä∑", "ÊôÆÈÄö", "ÊªØÈä∑"]}, editor: "select", editorParams: {values: ["ÁÜ±Èä∑", "ÊôÆÈÄö", "ÊªØÈä∑"]},
                     formatter: function(cell) {
                         const value = cell.getValue();
                         let className = "";
                         switch(value) {
                             case "ÁÜ±Èä∑": className = "high-value"; break;
                             case "ÊôÆÈÄö": className = "medium-value"; break;
                             case "ÊªØÈä∑": className = "low-value"; break;
                         }
                         return `<span class="${className}">${value}</span>`;
                     }
                    },
                    createActionColumn('products')
                ]
            });
            
            // ÂÆ¢Êà∂Ë°®Ê†º
            tables.customers = new Tabulator("#customers-table", {
                data: customersData,
                layout: "fitColumns",
                pagination: "local",
                paginationSize: 10,
                movableColumns: true,
                resizableRows: true,
                cellEdited: function(cell) {
                    const rowData = cell.getRow().getData();
                    saveRowData('customers', rowData);
                },
                columns: [
                    {title: "ID", field: "id", width: 80, hozAlign: "center", sorter: "number", headerFilter: "input"},
                    {title: "ÂÖ¨Âè∏ÂêçÁ®±", field: "name", width: 180, sorter: "string", headerFilter: "input", editor: "input"},
                    {title: "ËÅØÁµ°‰∫∫", field: "contact", width: 120, sorter: "string", headerFilter: "input", editor: "input"},
                    {title: "ÈõªË©±", field: "phone", width: 140, sorter: "string", headerFilter: "input", editor: "input"},
                    {title: "Email", field: "email", width: 200, sorter: "string", headerFilter: "input", editor: "input"},
                    {title: "Á≠âÁ¥ö", field: "level", width: 100, hozAlign: "center", sorter: "string", headerFilter: "select", headerFilterParams: {values: ["", "VIP", "ÈáëÁâå", "ÈäÄÁâå"]}, editor: "select", editorParams: {values: ["VIP", "ÈáëÁâå", "ÈäÄÁâå"]},
                     formatter: function(cell) {
                         const value = cell.getValue();
                         let className = "";
                         switch(value) {
                             case "VIP": className = "high-value"; break;
                             case "ÈáëÁâå": className = "medium-value"; break;
                             case "ÈäÄÁâå": className = "low-value"; break;
                         }
                         return `<span class="${className}">${value}</span>`;
                     }
                    },
                    createActionColumn('customers')
                ]
            });
            
            // Ë®ÇÂñÆË°®Ê†º
            tables.orders = new Tabulator("#orders-table", {
                data: ordersData,
                layout: "fitColumns",
                pagination: "local",
                paginationSize: 10,
                movableColumns: true,
                resizableRows: true,
                cellEdited: function(cell) {
                    const rowData = cell.getRow().getData();
                    saveRowData('orders', rowData);
                },
                columns: [
                    {title: "Ë®ÇÂñÆËôü", field: "id", width: 120, sorter: "string", headerFilter: "input", editor: "input"},
                    {title: "ÂÆ¢Êà∂", field: "customer", width: 150, sorter: "string", headerFilter: "input", editor: "input"},
                    {title: "Áî¢ÂìÅ", field: "product", width: 150, sorter: "string", headerFilter: "input", editor: multilineEditor, formatter: multilineFormatter},
                    {title: "Êï∏Èáè", field: "quantity", width: 100, hozAlign: "right", sorter: "number", headerFilter: "number", editor: "number"},
                    {title: "ÈáëÈ°ç", field: "amount", width: 150, hozAlign: "right", formatter: "money", formatterParams: {symbol: "NT$"}, sorter: "number", headerFilter: "number", editor: "number"},
                    {title: "ÁãÄÊÖã", field: "status", width: 100, hozAlign: "center", sorter: "string", headerFilter: "select", headerFilterParams: {values: ["", "Â∑≤ÂÆåÊàê", "ËôïÁêÜ‰∏≠", "ÂæÖÂá∫Ë≤®"]}, editor: "select", editorParams: {values: ["Â∑≤ÂÆåÊàê", "ËôïÁêÜ‰∏≠", "ÂæÖÂá∫Ë≤®"]},
                     formatter: function(cell) {
                         const value = cell.getValue();
                         let className = "";
                         switch(value) {
                             case "Â∑≤ÂÆåÊàê": className = "high-value"; break;
                             case "ËôïÁêÜ‰∏≠": className = "medium-value"; break;
                             case "ÂæÖÂá∫Ë≤®": className = "low-value"; break;
                         }
                         return `<span class="${className}">${value}</span>`;
                     }
                    },
                    {title: "Êó•Êúü", field: "date", width: 120, hozAlign: "center", sorter: "date", headerFilter: "input", editor: "date"},
                    createActionColumn('orders')
                ]
            });
            
            // ‰æõÊáâÂïÜË°®Ê†º
            tables.suppliers = new Tabulator("#suppliers-table", {
                data: suppliersData,
                layout: "fitColumns",
                pagination: "local",
                paginationSize: 10,
                movableColumns: true,
                resizableRows: true,
                cellEdited: function(cell) {
                    const rowData = cell.getRow().getData();
                    saveRowData('suppliers', rowData);
                },
                columns: [
                    {title: "ID", field: "id", width: 80, hozAlign: "center", sorter: "number", headerFilter: "input"},
                    {title: "‰æõÊáâÂïÜÂêçÁ®±", field: "name", width: 180, sorter: "string", headerFilter: "input", editor: "input"},
                    {title: "ËÅØÁµ°Ëôï", field: "contact", width: 150, sorter: "string", headerFilter: "input", editor: multilineEditor, formatter: multilineFormatter},
                    {title: "ÈõªË©±", field: "phone", width: 180, sorter: "string", headerFilter: "input", editor: "input"},
                    {title: "‰∏ªË¶ÅÁî¢ÂìÅ", field: "products", width: 200, sorter: "string", headerFilter: "input", editor: multilineEditor, formatter: multilineFormatter},
                    {title: "Ë©ïÁ¥ö", field: "rating", width: 100, hozAlign: "center", sorter: "string", headerFilter: "select", headerFilterParams: {values: ["", "A+", "A", "A-", "B+", "B"]}, editor: "select", editorParams: {values: ["A+", "A", "A-", "B+", "B"]},
                     formatter: function(cell) {
                         const value = cell.getValue();
                         let className = "";
                         if (value.startsWith("A")) {
                             className = "high-value";
                         } else if (value.startsWith("B")) {
                             className = "medium-value";
                         } else {
                             className = "low-value";
                         }
                         return `<span class="${className}">${value}</span>`;
                     }
                    },
                    createActionColumn('suppliers')
                ]
            });
            
            // Â†±Ë°®Ë°®Ê†º
            tables.reports = new Tabulator("#reports-table", {
                data: reportsData,
                layout: "fitColumns",
                pagination: "local",
                paginationSize: 10,
                movableColumns: true,
                resizableRows: true,
                cellEdited: function(cell) {
                    const rowData = cell.getRow().getData();
                    saveRowData('reports', rowData);
                },
                columns: [
                    {title: "ID", field: "id", width: 80, hozAlign: "center", sorter: "number", headerFilter: "input"},
                    {title: "Â†±Ë°®ÂêçÁ®±", field: "name", width: 200, sorter: "string", headerFilter: "input", editor: multilineEditor, formatter: multilineFormatter},
                    {title: "È°ûÂûã", field: "type", width: 150, sorter: "string", headerFilter: "input", editor: "input"},
                    {title: "ÊúÄÂæåÊõ¥Êñ∞", field: "lastUpdate", width: 120, hozAlign: "center", sorter: "date", headerFilter: "input", editor: "date"},
                    {title: "ÁãÄÊÖã", field: "status", width: 100, hozAlign: "center", sorter: "string", headerFilter: "select", headerFilterParams: {values: ["", "ÊúÄÊñ∞", "ÈúÄÊõ¥Êñ∞", "Â∑≤ÈÅéÊúü"]}, editor: "select", editorParams: {values: ["ÊúÄÊñ∞", "ÈúÄÊõ¥Êñ∞", "Â∑≤ÈÅéÊúü"]},
                     formatter: function(cell) {
                         const value = cell.getValue();
                         let className = "";
                         switch(value) {
                             case "ÊúÄÊñ∞": className = "high-value"; break;
                             case "ÈúÄÊõ¥Êñ∞": className = "medium-value"; break;
                             case "Â∑≤ÈÅéÊúü": className = "low-value"; break;
                         }
                         return `<span class="${className}">${value}</span>`;
                     }
                    },
                    {title: "Ê™îÊ°àÂ§ßÂ∞è", field: "size", width: 120, hozAlign: "right", sorter: "string", headerFilter: "input", editor: "input"},
                    createActionColumn('reports')
                ]
            });
            
            // Ë®≠ÂÆöË°®Ê†º
            tables.settings = new Tabulator("#settings-table", {
                data: settingsData,
                layout: "fitColumns",
                pagination: "local",
                paginationSize: 10,
                movableColumns: true,
                resizableRows: true,
                cellEdited: function(cell) {
                    const rowData = cell.getRow().getData();
                    saveRowData('settings', rowData);
                },
                columns: [
                    {title: "ID", field: "id", width: 80, hozAlign: "center", sorter: "number", headerFilter: "input"},
                    {title: "ÂäüËÉΩÊ®°ÁµÑ", field: "module", width: 150, sorter: "string", headerFilter: "input", editor: "input"},
                    {title: "Ë®≠ÂÆöÈ†ÖÁõÆ", field: "setting", width: 150, sorter: "string", headerFilter: "input", editor: "input"},
                    {title: "Ë®≠ÂÆöÂÄº", field: "value", width: 200, sorter: "string", headerFilter: "input", editor: multilineEditor, formatter: multilineFormatter},
                    {title: "ÁãÄÊÖã", field: "status", width: 100, hozAlign: "center", sorter: "string", headerFilter: "select", headerFilterParams: {values: ["", "ÂïüÁî®", "ÂÅúÁî®"]}, editor: "select", editorParams: {values: ["ÂïüÁî®", "ÂÅúÁî®"]},
                     formatter: function(cell) {
                         const value = cell.getValue();
                         let className = "";
                         switch(value) {
                             case "ÂïüÁî®": className = "high-value"; break;
                             case "ÂÅúÁî®": className = "low-value"; break;
                         }
                         return `<span class="${className}">${value}</span>`;
                     }
                    },
                    createActionColumn('settings')
                ]
            });
        }
        
        // È†ÅÁ±§ÂàáÊèõÂäüËÉΩ
        function showTab(tabName, tabElement) {
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            const targetContent = document.getElementById(tabName);
            if (targetContent) {
                targetContent.classList.add('active');
            }
            
            if (tabElement) {
                tabElement.classList.add('active');
                
                const tabsContainer = document.getElementById('tabs-container');
                const tabsViewport = document.getElementById('tabs-viewport');
                const tabIndex = Array.from(tabsContainer.children).indexOf(tabElement);
                const tabPosition = tabIndex * tabWidth;
                const viewportWidth = tabsViewport.offsetWidth;
                const containerWidth = tabsContainer.scrollWidth;
                const maxScroll = Math.max(0, containerWidth - viewportWidth);
                
                if (maxScroll > 0) {
                    if (tabPosition < tabScrollOffset || tabPosition + tabWidth > tabScrollOffset + viewportWidth) {
                        tabScrollOffset = Math.max(0, Math.min(maxScroll, tabPosition - viewportWidth / 2 + tabWidth / 2));
                        tabsContainer.style.transform = `translateX(-${tabScrollOffset}px)`;
                        
                        document.getElementById('tabs-left-btn').disabled = tabScrollOffset <= 0;
                        document.getElementById('tabs-right-btn').disabled = tabScrollOffset >= maxScroll;
                        
                        const visibleCount = Math.floor(viewportWidth / tabWidth);
                        const visibleStart = Math.floor(tabScrollOffset / tabWidth) + 1;
                        const visibleEnd = Math.min(9, visibleStart + visibleCount - 1);
                        document.getElementById('tabs-indicator').textContent = `${visibleStart}-${visibleEnd} / 9`;
                    }
                }
            }
            
            if (tables[tabName]) {
                setTimeout(() => {
                    Object.values(tables).forEach(table => autoResizeRows(table));
                }, 500);
            }
        }
        
        // ÂÖ®ÂüüÊêúÂ∞ãÂäüËÉΩ
        function searchTable(tableName, searchTerm) {
            if (tables[tableName]) {
                if (searchTerm.trim() === "") {
                    tables[tableName].clearFilter();
                } else {
                    let searchFields = [];
                    
                    switch(tableName) {
                        case 'sales':
                            searchFields = ['product', 'category', 'status'];
                            break;
                        case 'inventory':
                            searchFields = ['item', 'category', 'location', 'supplier', 'status'];
                            break;
                        case 'employees':
                            searchFields = ['name', 'department', 'position', 'performance', 'email'];
                            break;
                        case 'products':
                            searchFields = ['name', 'category', 'status'];
                            break;
                        case 'customers':
                            searchFields = ['name', 'contact', 'email', 'level'];
                            break;
                        case 'orders':
                            searchFields = ['id', 'customer', 'product', 'status'];
                            break;
                        case 'suppliers':
                            searchFields = ['name', 'contact', 'products', 'rating'];
                            break;
                        case 'reports':
                            searchFields = ['name', 'type', 'status'];
                            break;
                        case 'settings':
                            searchFields = ['module', 'setting', 'value', 'status'];
                            break;
                        default:
                            searchFields = ['name', 'product', 'item'];
                    }
                    
                    const filters = searchFields.map(field => ({
                        field: field,
                        type: "like",
                        value: searchTerm
                    }));
                    
                    tables[tableName].setFilter([filters]);
                }
            }
        }
        
        // Ê∏ÖÈô§ÊêúÂ∞ã
        function clearSearch(tableName) {
            const searchInput = document.getElementById(tableName + '-search');
            if (searchInput) {
                searchInput.value = "";
            }
            if (tables[tableName]) {
                tables[tableName].clearFilter();
            }
        }
        
        // È†ÅÁ±§ÊªæÂãïÂäüËÉΩ
        function scrollTabs(direction) {
            const tabsContainer = document.getElementById('tabs-container');
            const tabsViewport = document.getElementById('tabs-viewport');
            const leftBtn = document.getElementById('tabs-left-btn');
            const rightBtn = document.getElementById('tabs-right-btn');
            const indicator = document.getElementById('tabs-indicator');
            
            const viewportWidth = tabsViewport.offsetWidth;
            const containerWidth = tabsContainer.scrollWidth;
            const maxScroll = Math.max(0, containerWidth - viewportWidth);
            
            if (maxScroll <= 0) {
                return;
            }
            
            const scrollStep = tabWidth * 2;
            
            if (direction === 'left') {
                tabScrollOffset = Math.max(0, tabScrollOffset - scrollStep);
            } else {
                tabScrollOffset = Math.min(maxScroll, tabScrollOffset + scrollStep);
            }
            
            tabsContainer.style.transform = `translateX(-${tabScrollOffset}px)`;
            
            leftBtn.disabled = tabScrollOffset <= 0;
            rightBtn.disabled = tabScrollOffset >= maxScroll;
            
            const visibleCount = Math.floor(viewportWidth / tabWidth);
            const visibleStart = Math.floor(tabScrollOffset / tabWidth) + 1;
            const visibleEnd = Math.min(9, visibleStart + visibleCount - 1);
            indicator.textContent = `${visibleStart}-${visibleEnd} / 9`;
        }
        
        // ÂåØÂá∫ Excel ÂäüËÉΩÔºà‰ΩøÁî® ExcelJSÔºâ
        async function exportToExcel() {
            try {
                const workbook = new ExcelJS.Workbook();
                workbook.creator = 'Ë≥áÊñôÁÆ°ÁêÜÁ≥ªÁµ±';
                workbook.lastModifiedBy = 'Á≥ªÁµ±ÁÆ°ÁêÜÂì°';
                workbook.created = new Date();
                workbook.modified = new Date();
                
                await createSalesWorksheet(workbook);
                await createInventoryWorksheet(workbook);
                await createEmployeesWorksheet(workbook);
                await createProductsWorksheet(workbook);
                await createCustomersWorksheet(workbook);
                await createOrdersWorksheet(workbook);
                await createSuppliersWorksheet(workbook);
                await createReportsWorksheet(workbook);
                await createSettingsWorksheet(workbook);
                
                const fileName = `ÂÆåÊï¥Ë≥áÊñôÂ†±Ë°®_${new Date().toISOString().slice(0, 10)}.xlsx`;
                
                const buffer = await workbook.xlsx.writeBuffer();
                const blob = new Blob([buffer], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = fileName;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                window.URL.revokeObjectURL(url);
                
                alert(`üéâ Excel Ê™îÊ°àÂ∑≤ÊàêÂäüÂåØÂá∫Ôºö${fileName}\n\n‚úÖ ÂåÖÂê´ÂÆåÊï¥Ê®£ÂºèË®≠Ë®à\n‚úÖ Â§öÂ∑•‰ΩúË°®ÁµêÊßã\n‚úÖ Ê¢ù‰ª∂Ê†ºÂºèÂåñ\n‚úÖ Â∞àÊ•≠Ë°®Ê†ºÊ®£Âºè`);
            } catch (e) {
                console.error('ÂåØÂá∫ÈåØË™§:', e);
                alert('ÂåØÂá∫ÈÅéÁ®ã‰∏≠ÁôºÁîüÈåØË™§ÔºåË´ãÈáçË©¶');
            }
        }
        
        // ÂâµÂª∫ÂêÑÂ∑•‰ΩúË°®
        async function createSalesWorksheet(workbook) {
            const worksheet = workbook.addWorksheet('Èä∑ÂîÆË≥áÊñô');
            const headers = ['ID', 'Áî¢ÂìÅÂêçÁ®±', 'ÂàÜÈ°û', 'Êï∏Èáè', 'ÂñÆÂÉπ', 'Á∏ΩÈáëÈ°ç', 'ÁãÄÊÖã', 'Êó•Êúü'];
            const columnWidths = [8, 20, 15, 12, 18, 20, 12, 15];
            createWorksheet(worksheet, headers, columnWidths, salesData, 'Èä∑ÂîÆË≥áÊñôÂ†±Ë°®', 7);
        }
        
        async function createInventoryWorksheet(workbook) {
            const worksheet = workbook.addWorksheet('Â∫´Â≠òË≥áÊñô');
            const headers = ['ID', 'ÂìÅÈ†Ö', 'ÂàÜÈ°û', 'ÁèæÊúâÂ∫´Â≠ò', 'ÊúÄ‰ΩéÂ∫´Â≠ò', '‰ΩçÁΩÆ', '‰æõÊáâÂïÜ', 'ÁãÄÊÖã'];
            const columnWidths = [8, 20, 15, 15, 15, 12, 18, 12];
            createWorksheet(worksheet, headers, columnWidths, inventoryData, 'Â∫´Â≠òÁÆ°ÁêÜÂ†±Ë°®', 8);
        }
        
        async function createEmployeesWorksheet(workbook) {
            const worksheet = workbook.addWorksheet('Âì°Â∑•Ë≥áÊñô');
            const headers = ['ID', 'ÂßìÂêç', 'ÈÉ®ÈñÄ', 'ËÅ∑‰Ωç', 'Ëñ™Ë≥á', 'Á∏æÊïà', 'Âà∞ËÅ∑Êó•Êúü', 'Email'];
            const columnWidths = [8, 15, 15, 18, 18, 12, 15, 28];
            createWorksheet(worksheet, headers, columnWidths, employeesData, 'Âì°Â∑•Ë≥áÊñôÁµ±Ë®à', 6);
        }
        
        async function createProductsWorksheet(workbook) {
            const worksheet = workbook.addWorksheet('Áî¢ÂìÅË≥áÊñô');
            const headers = ['ID', 'Áî¢ÂìÅÂêçÁ®±', 'ÂàÜÈ°û', 'ÂÉπÊ†º', 'Â∫´Â≠ò', 'ÁãÄÊÖã'];
            const columnWidths = [8, 20, 18, 18, 12, 12];
            createWorksheet(worksheet, headers, columnWidths, productsData, 'Áî¢ÂìÅË≥áÊñôÁµ±Ë®à', 6);
        }
        
        async function createCustomersWorksheet(workbook) {
            const worksheet = workbook.addWorksheet('ÂÆ¢Êà∂Ë≥áÊñô');
            const headers = ['ID', 'ÂÖ¨Âè∏ÂêçÁ®±', 'ËÅØÁµ°‰∫∫', 'ÈõªË©±', 'Email', 'Á≠âÁ¥ö'];
            const columnWidths = [8, 20, 15, 18, 25, 12];
            createWorksheet(worksheet, headers, columnWidths, customersData, 'ÂÆ¢Êà∂Ë≥áÊñôÁµ±Ë®à', 6);
        }
        
        async function createOrdersWorksheet(workbook) {
            const worksheet = workbook.addWorksheet('Ë®ÇÂñÆË≥áÊñô');
            const headers = ['Ë®ÇÂñÆËôü', 'ÂÆ¢Êà∂', 'Áî¢ÂìÅ', 'Êï∏Èáè', 'ÈáëÈ°ç', 'ÁãÄÊÖã', 'Êó•Êúü'];
            const columnWidths = [15, 18, 18, 12, 20, 12, 15];
            createWorksheet(worksheet, headers, columnWidths, ordersData, 'Ë®ÇÂñÆË≥áÊñôÁµ±Ë®à', 6);
        }
        
        async function createSuppliersWorksheet(workbook) {
            const worksheet = workbook.addWorksheet('‰æõÊáâÂïÜË≥áÊñô');
            const headers = ['ID', '‰æõÊáâÂïÜÂêçÁ®±', 'ËÅØÁµ°Ëôï', 'ÈõªË©±', '‰∏ªË¶ÅÁî¢ÂìÅ', 'Ë©ïÁ¥ö'];
            const columnWidths = [8, 20, 18, 20, 25, 12];
            createWorksheet(worksheet, headers, columnWidths, suppliersData, '‰æõÊáâÂïÜË≥áÊñôÁµ±Ë®à', 6);
        }
        
        async function createReportsWorksheet(workbook) {
            const worksheet = workbook.addWorksheet('Â†±Ë°®ÂàÜÊûê');
            const headers = ['ID', 'Â†±Ë°®ÂêçÁ®±', 'È°ûÂûã', 'ÊúÄÂæåÊõ¥Êñ∞', 'ÁãÄÊÖã', 'Ê™îÊ°àÂ§ßÂ∞è'];
            const columnWidths = [8, 25, 18, 15, 12, 15];
            createWorksheet(worksheet, headers, columnWidths, reportsData, 'Â†±Ë°®ÂàÜÊûêÁµ±Ë®à', 5);
        }
        
        async function createSettingsWorksheet(workbook) {
            const worksheet = workbook.addWorksheet('Á≥ªÁµ±Ë®≠ÂÆö');
            const headers = ['ID', 'ÂäüËÉΩÊ®°ÁµÑ', 'Ë®≠ÂÆöÈ†ÖÁõÆ', 'Ë®≠ÂÆöÂÄº', 'ÁãÄÊÖã'];
            const columnWidths = [8, 18, 18, 25, 12];
            createWorksheet(worksheet, headers, columnWidths, settingsData, 'Á≥ªÁµ±Ë®≠ÂÆöÁµ±Ë®à', 5);
        }
        
        // ÂâµÂª∫Â∑•‰ΩúË°®
        function createWorksheet(worksheet, headers, columnWidths, data, title, statusColumn) {
            worksheet.getCell('A1').value = title;
            worksheet.getCell('A1').font = {
                name: 'Microsoft JhengHei',
                size: 16,
                bold: true,
                color: { argb: 'FF4472C4' }
            };
            worksheet.getCell('A1').alignment = {
                horizontal: 'left',
                vertical: 'middle'
            };
            
            for (let i = 0; i < headers.length; i++) {
                worksheet.getColumn(i + 2).width = columnWidths[i];
            }
            
            for (let i = 0; i < headers.length; i++) {
                const cell = worksheet.getCell(2, i + 2);
                cell.value = headers[i];
            }
            
            data.forEach((row, index) => {
                const rowNumber = index + 3;
                const values = Object.values(row);
                for (let i = 0; i < values.length; i++) {
                    const cell = worksheet.getCell(rowNumber, i + 2);
                    let value = values[i];
                    
                    if (typeof value === 'string' && (value.includes('\n') || value.includes('<br>'))) {
                        value = value.replace(/<br\s*\/?>/gi, '\n');
                        cell.value = value;
                        cell.alignment = {
                            wrapText: true,
                            vertical: 'top',
                            horizontal: 'left'
                        };
                        const estimatedLines = (value.match(/\n/g) || []).length + 1;
                        worksheet.getRow(rowNumber).height = Math.max(25, estimatedLines * 15);
                    } else {
                        cell.value = value;
                    }
                }
            });
            
            applyWorksheetStyles(worksheet, headers.length + 1, data.length, statusColumn);
        }
        
        // ÈÄöÁî®Ê®£ÂºèÊáâÁî®ÂáΩÊï∏
        function applyWorksheetStyles(worksheet, maxCol, dataLength, statusColumn) {
            const headerRow = worksheet.getRow(2);
            headerRow.height = 30;
            
            for (let col = 2; col <= maxCol; col++) {
                const cell = worksheet.getCell(2, col);
                cell.fill = {
                    type: 'pattern',
                    pattern: 'solid',
                    fgColor: { argb: 'FF4472C4' }
                };
                cell.font = {
                    name: 'Microsoft JhengHei',
                    color: { argb: 'FFFFFFFF' },
                    bold: true,
                    size: 12
                };
                cell.alignment = {
                    horizontal: 'center',
                    vertical: 'middle'
                };
                cell.border = {
                    top: { style: 'medium', color: { argb: 'FF2F5597' } },
                    left: { style: 'medium', color: { argb: 'FF2F5597' } },
                    bottom: { style: 'medium', color: { argb: 'FF2F5597' } },
                    right: { style: 'medium', color: { argb: 'FF2F5597' } }
                };
            }
            
            for (let rowNum = 3; rowNum <= dataLength + 2; rowNum++) {
                const row = worksheet.getRow(rowNum);
                row.height = 25;
                
                for (let col = 2; col <= maxCol; col++) {
                    const cell = worksheet.getCell(rowNum, col);
                    
                    cell.font = {
                        name: 'Microsoft JhengHei',
                        size: 11
                    };
                    cell.alignment = {
                        horizontal: 'center',
                        vertical: 'middle'
                    };
                    cell.border = {
                        top: { style: 'thin', color: { argb: 'FFD0D7DE' } },
                        left: { style: 'thin', color: { argb: 'FFD0D7DE' } },
                        bottom: { style: 'thin', color: { argb: 'FFD0D7DE' } },
                        right: { style: 'thin', color: { argb: 'FFD0D7DE' } }
                    };
                    
                    const cellValue = cell.value;
                    if (typeof cellValue === 'number' && cellValue > 1000) {
                        cell.alignment.horizontal = 'right';
                        cell.numFmt = '#,##0';
                    }
                    
                    if (col === statusColumn + 1) {
                        const value = cell.value;
                        let fillColor, fontColor;
                        
                        if (['È´ò', 'ÂÖÖË∂≥', 'ÂÑ™ÁßÄ', 'ÁÜ±Èä∑', 'VIP', 'Â∑≤ÂÆåÊàê', 'A+', 'A', 'ÊúÄÊñ∞', 'ÂïüÁî®'].includes(value)) {
                            fillColor = 'FFC6EFCE';
                            fontColor = 'FF006100';
                        } else if (['‰∏≠', 'Ê≠£Â∏∏', 'ËâØÂ•Ω', 'ÊôÆÈÄö', 'ÈáëÁâå', 'ËôïÁêÜ‰∏≠', 'A-', 'B+', 'ÈúÄÊõ¥Êñ∞'].includes(value)) {
                            fillColor = 'FFFFEB9C';
                            fontColor = 'FF9C5700';
                        } else if (['‰Ωé', '‰∏çË∂≥', 'ÊªØÈä∑', 'ÈäÄÁâå', 'ÂæÖÂá∫Ë≤®', 'B', 'Â∑≤ÈÅéÊúü', 'ÂÅúÁî®'].includes(value)) {
                            fillColor = 'FFFFC7CE';
                            fontColor = 'FF9C0006';
                        }
                        
                        if (fillColor) {
                            cell.fill = {
                                type: 'pattern',
                                pattern: 'solid',
                                fgColor: { argb: fillColor }
                            };
                            cell.font.color = { argb: fontColor };
                            cell.font.bold = true;
                        }
                    }
                    
                    if (rowNum % 2 === 0 && col !== statusColumn + 1) {
                        cell.fill = {
                            type: 'pattern',
                            pattern: 'solid',
                            fgColor: { argb: 'FFF2F2F2' }
                        };
                    }
                }
            }
        }
        
        // ÂàùÂßãÂåñÈ†ÅÁ±§ÊªæÂãïÁãÄÊÖã
        function initTabScrolling() {
            const tabsViewport = document.getElementById('tabs-viewport');
            const tabsContainer = document.getElementById('tabs-container');
            const leftBtn = document.getElementById('tabs-left-btn');
            const rightBtn = document.getElementById('tabs-right-btn');
            const indicator = document.getElementById('tabs-indicator');
            
            tabScrollOffset = 0;
            tabsContainer.style.transform = 'translateX(0px)';
            
            const viewportWidth = tabsViewport.offsetWidth;
            const containerWidth = tabsContainer.scrollWidth;
            const maxScroll = Math.max(0, containerWidth - viewportWidth);
            
            if (maxScroll <= 0) {
                leftBtn.disabled = true;
                rightBtn.disabled = true;
                indicator.textContent = '1-9 / 9';
            } else {
                leftBtn.disabled = true;
                rightBtn.disabled = false;
                const visibleCount = Math.floor(viewportWidth / tabWidth);
                indicator.textContent = `1-${Math.min(visibleCount, 9)} / 9`;
            }
        }
        
        // ÈüøÊáâÂºèË™øÊï¥
        function handleResize() {
            setTimeout(() => {
                initTabScrolling();
                
                const activeTab = document.querySelector('.tab.active');
                if (activeTab) {
                    const tabName = activeTab.getAttribute('data-tab');
                    if (tables[tabName]) {
                        tables[tabName].redraw();
                    }
                }
            }, 100);
        }
        
        // ÈçµÁõ§Âø´Êç∑ÈçµÊîØÊè¥
        function handleKeyboardShortcuts(event) {
            if (event.ctrlKey) {
                const tabs = document.querySelectorAll('.tab');
                const activeTab = document.querySelector('.tab.active');
                const currentIndex = Array.from(tabs).indexOf(activeTab);
                
                if (event.key === 'ArrowLeft' && currentIndex > 0) {
                    event.preventDefault();
                    const prevTab = tabs[currentIndex - 1];
                    const tabName = prevTab.getAttribute('data-tab');
                    showTab(tabName, prevTab);
                } else if (event.key === 'ArrowRight' && currentIndex < tabs.length - 1) {
                    event.preventDefault();
                    const nextTab = tabs[currentIndex + 1];
                    const tabName = nextTab.getAttribute('data-tab');
                    showTab(tabName, nextTab);
                }
            }
        }
        
        // È†ÅÈù¢ËºâÂÖ•ÂÆåÊàêÂæåÂàùÂßãÂåñ
        document.addEventListener('DOMContentLoaded', function() {
            initTables();
            initTabScrolling();
            
            window.addEventListener('resize', handleResize);
            document.addEventListener('keydown', handleKeyboardShortcuts);
            
            // ÁÇ∫È†ÅÁ±§Ê∑ªÂä†Ëß∏ÊéßÊªëÂãïÊîØÊè¥
            let touchStartX = 0;
            let touchEndX = 0;
            
            const tabsViewport = document.getElementById('tabs-viewport');
            
            tabsViewport.addEventListener('touchstart', function(e) {
                touchStartX = e.changedTouches[0].screenX;
            });
            
            tabsViewport.addEventListener('touchend', function(e) {
                touchEndX = e.changedTouches[0].screenX;
                handleTabSwipe();
            });
            
            function handleTabSwipe() {
                const swipeThreshold = 50;
                const diff = touchStartX - touchEndX;
                
                if (Math.abs(diff) > swipeThreshold) {
                    if (diff > 0) {
                        scrollTabs('right');
                    } else {
                        scrollTabs('left');
                    }
                }
            }
        });
    </script>
</body>
</html>